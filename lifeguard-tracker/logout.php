<?php
/**
 * logout.php
 *
 * Скрипт для виходу користувача з системи.
 * Очищує сесію та перенаправляє на сторінку входу.
 */

// Запустити сесію, якщо вона ще не запущена (безпечна практика)
if (session_status() == PHP_SESSION_NONE) {
    session_start();
}

// 1. Отримати поточні параметри cookie сесії
$params = session_get_cookie_params();

// 2. Встановити cookie сесії з минулим часом життя, щоб видалити її з браузера
// Це рекомендується для повного очищення
setcookie(session_name(), '', time() - 42000,
    $params["path"], $params["domain"],
    $params["secure"], $params["httponly"]
);

// 3. Знищити всі змінні сесії
$_SESSION = array();

// 4. Знищити сесію на сервері
session_destroy();

// 5. (Опціонально) Встановити повідомлення про успішний вихід
// Для цього потрібно знову запустити сесію лише для передачі повідомлення
session_start();
$_SESSION['flash_message'] = ['type' => 'успіх', 'text' => 'Ви успішно вийшли з системи.'];
// Важливо закрити сесію перед перенаправленням, щоб повідомлення збереглося
session_write_close();

// 6. Перенаправити користувача на сторінку входу
header('Location: login.php');
exit(); // Завжди викликайте exit() після header('Location: ...')

?>